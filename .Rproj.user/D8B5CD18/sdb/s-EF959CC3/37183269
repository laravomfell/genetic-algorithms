{
    "collab_server" : "",
    "contents" : "# clearing the memory\nrm(list = ls())\n\n# libraries\nlibrary(tictoc)\nlibrary(data.table)\n\nlibrary(caret)\nlibrary(randomForest)\nlibrary(xgboost)\nlibrary(Matrix)\nlibrary(SparseM)\nlibrary(foreach)\nlibrary(doParallel) \nlibrary(compiler)\n\n\n# loading required helper functions\nsource(\"code/prediction_helper.R\")\nsource(\"code/ga_helper.R\")\nsource(\"code/genetic_algorithms.R\")\n\n# loading data version 2.8\nload(\"data/data_2_8_full.Rda\")\nload(\"data/final_predictions.Rda\")\n\n# loading feature sets\nload(\"data/var_ranks_2_4.Rda\")\nload(\"data/features_2_4_rfopt.Rda\")\nload(\"data/errors_2_4_xgb.R\")\n\n\n# splitting training and testing\nd.class <- df[ is.na(df$returnQuantity),]\nd.label <- df[!is.na(df$returnQuantity),]\nrm(df)\n\n# listing variables which are not used as predictors\nunused.vars <- c(\"unique_ID\", \"returnQuantity\", \"orderID\", \"orderDate\", \"articleID\", \"voucherID\", \n                 \"customerID\", \"colorCode\", \"special_group\")\n\n#==========================================\n# Model Parameters\n\n# Fixed ones\n\n# for \npbil.prob <- 0.02\npbil.shift <- 0.05\npbil.size  <- c(30, 100, 300)\npbil.lr <- c(0.05, 0.1)\n\npsol.size <- c(30, 100, 300)\npsol.phi <- seq(1.8, 2.1, 0.1)\n \npsog.size <- c(30, 100, 300)\npsog.phi <- seq(1.8, 2.1, 0.1)\n\nga.cross <- 0.8 # c\nga.elit <- c(0.03, 0.1, 0.3)\nga.size <- c(30, 100, 300)\nga.mut <- 0.05\n\n\nbsa.mixrate <- c(0.5, 1)\nbsa.size <- c(30, 100, 300)\n\npbil.grid <- expand.grid(size = pbil.size, lr = pbil.lr)\npsol.grid <- expand.grid(size = psol.size, phi = psol.phi)\npsog.grid <- expand.grid(size=psog.size, phi = psog.phi)\nga.grid   <- expand.grid(size=ga.size, elit = ga.elit)\nbsa.grid  <- expand.grid(size=bsa.size, mixrate= bsa.mixrate)\n\n\n#############################################\n#                                           #\n#             3. DATA PREPARATION           #\n#                                           #\n#############################################\n\n# diplaying information\nprint(\"Preparing the data...\")\n\n# marking unused variables\ndrops <- names(df) %in% unused.vars\n\n# creating features and imputing values [level 1]\ndata    <- add_returns(d.label, d.class)\nd.label <- data$train\nd.class <- data$test\nd.label <- d.label[, !colnames(d.label) %in% \"new\"]\nrm(data)\n\n# sorting coloumns in datasets\nd.label   <- d.label[,   order(names(d.label))]\nd.class  <- d.class[, order(names(d.class))]\n\n# remarking unused variables\ndrops <- names(d.label) %in% unused.vars\n\n# saving feature lists\nx.vars <- c(names(var.ranks[1:which.min(x.errors)]), \"returnBin\", \"C1\", \"C2\", \"C3\", \"C4\", \"C5\", \"saswoXt\")\nr.vars <- attr(terms(r.vars), \"term.labels\")\nr.vars <- paste(r.vars, collapse = \" + \")\nr.vars <- paste(\"returnBin ~ \", r.vars, \" + C1 + C2 + C3 + C4 + C5 + saswoXt\", sep=\"\")\nr.vars <- as.formula(r.vars)\n\n# additional data transformations [level 1]\nd.class$returnBin <- \"NA\"\nx.y <- as.numeric(d.label$returnBin)-1\nx.x <- sparse.model.matrix(returnBin ~ . -1, data = d.label[x.vars])\nx.v <- sparse.model.matrix(returnBin ~ . -1, data = d.class[x.vars])\n\n# creating error matrix\n# errors <- vector(mode = \"numeric\", length = models)\n# names(errors) <- rep(\"NA\", length(errors))\n# names(errors)[(1):(nrow(f.grid))] <- \"RF\"\n# names(errors)[(1+nrow(f.grid)):(length(errors))] <- \"XGB\"\n# \n# # creating predictions matrix\n# predictions <- matrix(nrow = nrow(d.class),   ncol = models)\n# colnames(predictions) <- names(errors) \n\n# information\ntime.set[[1, 2]] <- proc.time()\ntime.trial <- proc.time() - time.set[[1, 1]]\nprint(paste0(\"Data preparation took \", round(time.trial[3]/60, digits = 0), \" minutes.\"))\n#beep(5)\n\nload(\"data/final_predictions.Rda\")\nd.valid <- dd\nforecasts <- \n\n",
    "created" : 1540194542752.000,
    "dirty" : false,
    "encoding" : "ISO8859-1",
    "folds" : "",
    "hash" : "28359556",
    "id" : "37183269",
    "lastKnownWriteTime" : 1540224021,
    "last_content_update" : 1540224021487,
    "path" : "C:/Users/Lara/One Drive - Warwick/OneDrive - University of Warwick/GeneticAgorithm/code/final_code.R",
    "project_path" : "code/final_code.R",
    "properties" : {
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}